{%- set isDetailView = layout == 'note' -%}

{% if isDetailView %}
  {%- set note = page -%}
{% else %}
  {%- set tags = note.data.tags -%}
{% endif %}

<div class="note {% if isDetailView %}note--detail{% endif %} h-entry">
  <div class="note__main">
    <div class="note__meta">
      <time
        class="note__date dt-published"
        datetime="{{ note.date | dateToISO }}"
      >
        {{ note.date | readableDate('dd LLL yyyy HH:mm') }}
      </time>
      {% if tags %}
        <div class="note__tags">
          {% for tag in tags %}
            <span class="note__tag">{{ tag }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </div>
    <div class="note__content">
      <div class="e-content p-name markdown">
        {% if isDetailView %}
          {% if title %}<h1 class="note__title">{{ title }}</h1>{% endif %}
          {{ content | safe }}
        {% else %}
          <a
            href="{{ note.url }}"
            class="note__link"
            aria-label="View note: {{ note.data.title or 'Note from ' ~ (note.date | readableDate('dd LLL yyyy')) }}"
          >
            {% if note.data.title %}
              <h2 class="note__title">{{ note.data.title }}</h2>
            {% endif %}
          </a>
          {{ note.templateContent | safe }}
        {% endif %}
      </div>
    </div>
  </div>
  {% if isDetailView %}

  {% else %}
    <a href="{{ note.url }}" class="note__link__overlay">
      <span class="sr-only">View Note</span>
    </a>
  {% endif %}
</div>
